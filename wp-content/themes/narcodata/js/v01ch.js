var visualizacion_h=function(){function t(){te.attr("transform","translate("+st+",0)");var t=queue(1);t.defer(window.d3.tsv,"tsv/presidentes.tsv",function(t){return{id:t.id,nombre:t.nombre,inicio:+t.inicio,fotografia:"img/"+t.fotografia,nombrecorto:t.nombrecorto,click:!1}}),t.defer(window.d3.tsv,"tsv/carteles.tsv",function(t){return{id:t.id,nombre:t.nombre,nombree:t.nombree,nombrelargo:t.nombrelargo,fila:+t.fila,mitad:"1"===t.mitad?!0:!1,fondo:t.fondo,color:t.color,borde:t.borde,anillo:t.anillo,inicio:+t.inicio,fin:+t.fin,porcentaje:+t.porcentaje,pleca:"1"===t.pleca?!0:!1,lineaini:t.lineaini,lineafin:t.lineafin,inicial:t.inicial,inicialc:t.inicialc,lideres:t.lideres.split("|"),x:0,y:0,w:0,h:0,yi:0,yf:0}}),t.defer(window.d3.tsv,"tsv/origenes.tsv",function(t){return{origen:t.origen,destino:t.destino,offset:+t.offset}}),t.defer(window.d3.tsv,"tsv/federaciones.tsv",function(t){return{id:t.id,nombre:t.nombre,lideres:t.lideres.split("|"),inicio:+t.inicio,fin:+t.fin,color:t.color,fuente:t.fuente,w:0,y:0,x:0}}),t.defer(window.d3.tsv,"tsv/federacionescarteles.tsv",function(t){return{id:t.id,aliados:t.aliados.split("|"),involucrados:t.involucrados.split("|"),x:0,y:500}}),t.defer(window.d3.tsv,"tsv/conflictos.tsv",function(t){return{presidente:t.presidente,bando1:t.bando1.split("|"),bando2:t.bando2.split("|"),federacion:t.federacion,descripcion:t.descripcion,inicio:+t.inicio,fin:+t.fin,numero:+t.numero,total:+t.total}}),t.awaitAll(e)}function e(t,e){dt=e[0],ft=e[1],ut=e[2],pt=e[3],yt=e[4],ht=e[5],xt=[],window._.each(dt,function(t){var e=1;for(e=1;6>=e;e++)xt.push(t)}),_t=2*mt;var r=window._.indexBy(ft,"fila"),i=window._.pluck(r,"fila"),c=(Q+Z)*i.length+U,s=G*dt.length,d=K*dt.length,p=C(s),w=[-st,p],x=Nt/2,g=[x,s-x],v=window.d3.scale.linear();v.domain(w),v.range(g);var _=window.d3.scale.linear();_.domain(g),_.range(w),Ot.attr("fill","#ffffff").attr("width",s+st).attr("height",c),re.append("rect").attr("fill","#cdcdcd").attr("x",0).attr("y",0).attr("width",st).attr("height",U).style("stroke","#ffffff").style("stroke-width",2),re.append("rect").attr("fill","#58595b").attr("x",0).attr("y",U).attr("width",st).attr("height",c).attr("class","eje").style("stroke","#ffffff").style("stroke-width",2).on("click",O),$t.append("rect").attr("fill","transparent").attr("x",0).attr("y",0).attr("width",d).attr("height",c).attr("class","grab"),q(s,c,v),n(),E(),o(),f(),y(),b(),ajustaCarteles(),m(),a(),generaFederacionesE(),l(),u(),h(),k(),A(),wt=L(ht),generaConflictos(),generaHilos(),S(s,ot),Ct.attr("preserveAspectRatio","xMidYMid"),Ct.attr("viewBox","0 0 "+(s+st)+" "+(ot+qt+2*jt)),re.append("text").attr("transform","rotate(270 "+(st/2+6)+","+(ot/2+U)+")").attr("x",st/2+6).attr("y",ot/2+U).style("stroke","#ffffff").style("fill","#ffffff").style("text-transform","uppercase").style("font-size",18).style("font-family",'"Helvetica Neue",Helvetica,Arial,sans-serif').style("letter-spacing",5).on("click",O).text("Cárteles"),N(s,c),z(),St.select("rect").attr("fill","#ffffff").style("opacity",.7).attr("x",0).attr("y",0).attr("width",d).attr("height",c).attr("class","ignorar"),Rt.append("rect").attr("x",0).attr("y",0).style("fill","transparent").attr("width",6*K*dt.length).attr("height",ot);var H=window.d3.behavior.drag().on("dragstart",I).on("drag",function(){F(w,v)}).on("dragend",B);$t.selectAll("rect").call(H),Lt.selectAll("rect").call(H),Lt.selectAll("text").call(H),Lt.selectAll("image").call(H);var j=window.d3.behavior.drag().on("dragstart",Y).on("drag",function(){T(g,_)}).on("dragend",P);Dt.select("g.slidercontrolgroup").call(j),Dt.select("rect").on("click",function(){V(this,g,_)}),Kt.remove(),Qt.remove(),Ut.remove(),Zt.remove(),ee.remove(),ne.remove()}function n(){ee.selectAll("rect").data(dt).enter().append("rect").attr("x",function(t,e){return e*G}).attr("y",0).attr("width",G).attr("height",U).attr("fill","#000000").style("stroke","#ffffff").style("stroke-width",2).attr("class","presidente"),ee.selectAll("text.periodo").data(dt).enter().append("text").attr("class","periodo ignorar").attr("x",function(t,e){return r(e)}).attr("y",rt).style("font-size","24px").style("font-weight","bold").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').attr("fill","#ffffff").attr("text-anchor","middle").text(function(t){var e=t.inicio+" - "+(t.inicio+6);return"EPN"==t.id&&(e=t.inicio+" a 2014"),e}),ee.selectAll("text.presidente").data(dt).enter().append("text").attr("class","presidente ignorar").attr("x",function(t,e){return r(e)}).attr("y",nt).style("font-size","12px").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').attr("fill","#ffffff").attr("text-anchor","middle").text(function(t){return t.nombre}),ee.selectAll("circle.conflictos.presidente").data(dt).enter().append("circle").attr("class","conflictos presidente ignorar").attr("cx",function(t,e){return t.cx=lt/2+(e+1)*G-(lt+ct),t.cx}).attr("cy",function(t){return t.cy=lt/2+(U-lt)/2,t.cy}).attr("r",At).style("fill","#ffffff").style("stroke","#ff0000").style("stroke-width","3px"),ee.selectAll("text.conflictos.presidente.ignorar").data(dt).enter().append("text").attr("class","conflictos presidente ignorar").attr("x",function(t,e){return lt/2+(e+1)*G-(lt+ct)}).attr("y",function(t){return 12+lt/2+(U-lt)/2}).style("font-size","35px").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').attr("fill","#ff0000").attr("text-anchor","middle").text(function(t){var e=t.id,n=window._.select(ht,function(t){return t.presidente===e?!0:!1});return n.length})}function r(t){var e=t*G+ct,n=G-(lt+2*ct);return n/2+e}function a(){Lt.selectAll("rect").data(xt).enter().append("rect").attr("x",function(t,e){return e*G}).attr("y",0).attr("width",G).attr("height",U).attr("fill","#000000").style("stroke","#ffffff").style("stroke-width",2),Lt.append("line").style("stroke","#ffffff").style("stroke-width",2).style("opacity",1).attr("x1",0).attr("y1",U/2).attr("x2",xt.length*G).attr("y2",U/2),Lt.selectAll("text.periodo").data(xt).enter().append("text").attr("class","periodo").attr("x",function(t,e){return i(e)}).attr("y",rt-5).style("font-size","20px").style("font-weight","normal").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').attr("fill","#ffffff").attr("text-anchor","middle").text(function(t){return t.nombrecorto}),Lt.selectAll("text.presidente").data(xt).enter().append("text").attr("class","presidente").attr("x",function(t,e){return i(e)}).attr("y",nt+2).style("font-size","16px").style("font-weight","bold").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').attr("fill","#ffffff").attr("text-anchor","middle").text(function(t,e){return e%6+t.inicio}),Lt.selectAll(".fotografia.presidente").data(xt).enter().append("svg:image").attr("width",lt).attr("height",lt).attr("class","presidente fotografia").attr("xlink:href",function(t){return t.fotografia}).attr("x",function(t,e){return e*G-lt/2}).attr("y",function(t){return(U-lt)/2})}function i(t){var e=t*G,n=G;return n/2+e}function o(){var t=dt.length+1,e=0,n=(Q+Z)*ft.length,r=1;for(r=1;t>=r;r++)ne.append("line").style("stroke","#ffffff").style("stroke-width",2).style("opacity",1).attr("x1",e).attr("y1",U).attr("x2",e).attr("y2",U+n),e=r*G}function l(){var t=xt.length+1,e=0,n=(Q+Z)*ft.length,r=1;for(r=1;t>=r;r++)Tt.append("line").style("stroke","#000000").style("stroke-width",function(t){var e=1;return(r-1)%6===0&&(e=5),e}).style("opacity",1).attr("x1",e).attr("y1",U).attr("x2",e).attr("y2",U+n).attr("class","ignorar").style("stroke-dasharray",function(t){var e="1,3";return(r-1)%6===0&&(e="1,0"),e}),e=r*G}function c(){var t=window._.min(dt,function(t){return t.inicio});return t.inicio}function s(t){return Math.ceil(Q*t/100)}function d(t){return Math.ceil((Q-t)/2)}function f(){var t=c(),e=0,n=0,r=0,a=0,i=0,o=0,l=0,f=0;window._.each(ft,function(c){n=U+(Q+Z)*c.fila-Q,c.mitad&&(n+=Q/2),f=s(c.porcentaje),l=n+d(f),o=l+f,a=(c.inicio-t)*D,i=(c.fin-t)*D,e=a,r=i-a,c.x=e,c.y=n,c.w=r,c.h=f,c.yf=o,c.yi=l}),Qt.selectAll("rect.cartel").data(ft).enter().append("rect").attr("class",function(t){return"cartel "+t.id}).attr("x",function(t){return t.x}).attr("y",function(t){return t.yi}).attr("width",function(t){return t.w}).attr("height",function(t){return t.h}).attr("fill",function(t){return t.fondo}).attr("stroke",function(t){return t.fondo}).attr("stroke-width",1)}function u(){var t=c(),e=0,n=0,r=0,a=0;window._.each(ft,function(i){r=(i.inicio-t)*J,a=(i.fin-t)*J,e=r,n=a-r,i.xE=e,i.wE=n}),window._.each(ft,function(i){var o=0;for(o=i.inicio;o<i.fin;o++){var l=window._.clone(i);l.anio=o,r=(l.anio-t)*J,a=(l.anio+1-t)*J,e=r,n=a-r,l.xE=e,l.wE=n,ie.push(l)}}),Bt.selectAll("rect.cartel").data(ie).enter().append("rect").attr("class",function(t){return"pointer cartel "+t.id}).attr("x",function(t){return t.xE}).attr("y",function(t){return t.yi}).attr("width",function(t){return t.wE}).attr("height",function(t){return t.h}).attr("fill",function(t){return t.fondo}).attr("stroke",function(t){return t.fondo}).attr("stroke-width",1).on("mouseover",function(t){null===ae&&(window._.each(ie,function(e){if("organizacion-de-sinaloa"==t.id||"guadalajara"==t.id){var n=!1;("organizacion-de-sinaloa"==e.id||"guadalajara"==e.id)&&(n=!0),e.resaltar=n}else e.resaltar=e.id==t.id?!0:!1}),p())}).on("mouseout",function(t){null===ae&&(window._.each(ie,function(t){t.resaltar=!1}),p())}).on("click",function(t){ae===t.id?(ae=null,window._.each(ie,function(t){t.resaltar=!1})):(ae=t.id,window._.each(ie,function(e){if("organizacion-de-sinaloa"==t.id||"guadalajara"==t.id){var n=!1;("organizacion-de-sinaloa"==e.id||"guadalajara"==e.id)&&(n=!0),e.resaltar=n}else e.resaltar=e.id==t.id?!0:!1})),p()}),Pt.selectAll("rect.cartel").data(ie,function(t){return t.id+"-"+t.anio}).enter().append("rect").attr("class",function(t){return"pointer ignorar cartel "+t.id}).attr("x",function(t){return t.xE}).attr("y",function(t){return t.yi}).attr("width",function(t){return t.wE}).attr("height",function(t){return t.h}).attr("fill",function(t){return t.fondo}).attr("stroke",function(t){return t.fondo}).attr("stroke-width",1).style("opacity",.8).style("display","none")}function p(){var t=[],e=[],n=[],r=window._.select(ie,function(t){return t.resaltar});e=window._.uniq(window._.pluck(r,"id")),n=window._.uniq(window._.pluck(r,"id")),window._.each(r,function(e){t.push(e.id+"-"+e.anio)});var a=[];window._.each(r,function(t){var e=window._.select(wt,function(e){return e.cartel.id===t.id});window._.each(e,function(t){window._.each(t.oponentes,function(e){window._.each(e,function(e){a.push(e.id+"-"+t.anio)})})})}),a=window._.uniq(a),r=window._.select(ie,function(t){return a.indexOf(t.id+"-"+t.anio)>=0?!0:!1});window._.uniq(window._.pluck(r,"id"));window._.each(r,function(e){t.push(e.id+"-"+e.anio)}),t=window._.uniq(t);var i=window._.select(ie,function(e){return t.indexOf(e.id+"-"+e.anio)>=0?!0:!1});Pt.selectAll("rect.cartel").style("display","none"),Pt.selectAll("rect.cartel").data(i,function(t){return t.id+"-"+t.anio}).style("display",function(e){var n=e.id+"-"+e.anio,r="none";return t.indexOf(n)>=0,r="block"}),Wt.selectAll("text.cartel.normal").style("display",function(n){var r="none",a=n.id+"-"+n.anio;return t.indexOf(a)>=0&&e.indexOf(n.id)<0&&(r="block"),r}),Vt.selectAll("rect.etiqueta.normal").style("display",function(n){var r="none",a=n.clase+"-"+n.anio;return t.indexOf(a)>=0&&e.indexOf(n.id)<0&&(r="block"),r}),Wt.selectAll("text.cartel.resaltado").style("display",function(t){var n="none";return e.indexOf(t.id)>=0&&(n="block"),n}),Vt.selectAll("rect.etiqueta.resaltado").style("display",function(t){var n="none";return e.indexOf(t.clase)>=0&&(n="block"),n}),Xt.selectAll("path.cartel").style("display",function(t){var e="none";return n.indexOf(t.cartel.id)>=0&&(e="block"),e}),Xt.selectAll("path.punta").style("display",function(t){var e="none";return n.indexOf(t.cartel.id)>=0&&(e="block"),e})}function y(){var t=window._.select(ft,function(t){return""!==t.nombre});Zt.selectAll("text.cartel").data(t).enter().append("text").attr("class","cartel").attr("class",function(t){return"cartel "+t.id}).attr("fill","#ffffff").style("font-weight","bold").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",12).attr("text-anchor","middle").attr("x",function(t){return t.x+Math.ceil(t.w/2)}).attr("y",function(t){return t.y+30}).text(function(t){return t.nombre}),Zt.selectAll("text.cartel").call(w),Zt.selectAll("text.wrapped").call(g)}function w(t){t.each(function(){for(var t,e=window.d3.select(this),n=e.text().split(/\s+/).reverse(),r=e.attr("class"),a=[],i=0,o=1.2,l=e.attr("y"),c=parseFloat(e.attr("dy")||0),s=e.attr("class","wrapped "+r).text(null).append("tspan").attr("class",r).attr("x",e.attr("x")).attr("y",l).attr("dy",c+"em");t=n.pop();)a.push(t),s.text(a.join(" ")),s.node().getComputedTextLength()>e.datum().w-30&&(a.pop(),s.text(a.join(" ")),a=[t],s=e.append("tspan").attr("class",r).attr("x",e.attr("x")).attr("y",l).attr("dy",++i*o+c+"em").text(t))})}function h(){var t=(2*_(tt),window._.select(ft,function(t){return""!==t.nombree})),e=[],n=c();window._.each(t,function(t){var r=0;for(r=t.inicio;r<t.fin;r++){var a=window._.clone(t);a.anio=r,a.xE=(r-n)*J+Math.ceil(J/2),e.push(a)}}),St.selectAll("text.cartel").data(e).enter().append("text").attr("class","cartel").attr("class",function(t){return"cartel "+t.id}).attr("fill","#ffffff").style("font-weight","bold").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",12).attr("text-anchor","middle").attr("x",function(t){return t.xE}).attr("y",function(t){return t.y+30}).text(function(t){return t.nombree}),St.selectAll("text.cartel").call(x),St.selectAll("text.wrapped").call(g),Wt.selectAll("text.cartel.normal").data(e).enter().append("text").attr("class",function(t){return"ignorar cartel normal "+t.id}).attr("fill","#ffffff").style("font-weight","bold").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",12).attr("text-anchor","middle").attr("x",function(t){return t.xE}).attr("y",function(t){return t.y+30}).text(function(t){return t.nombree}),Wt.selectAll("text.cartel.normal").call(x),Wt.selectAll("text.wrapped.normal").call(g),Wt.selectAll("text.cartel.normal").style("display","none"),Wt.selectAll("text.cartel.resaltado").data(e).enter().append("text").attr("class",function(t){return"ignorar cartel resaltado "+t.id}).attr("fill","#ffffff").style("font-weight","bold").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",14).style("text-transform","uppercase").attr("text-anchor","middle").attr("x",function(t){return t.xE}).attr("y",function(t){return t.y+30}).text(function(t){return t.nombree}),Wt.selectAll("text.cartel.resaltado").call(x),Wt.selectAll("text.wrapped.resaltado").call(g),Wt.selectAll("text.cartel.resaltado").style("display","none")}function x(t){t.each(function(){for(var t,e=window.d3.select(this),n=e.text().split(/\s+/).reverse(),r=e.attr("class"),a=[],i=0,o=1.2,l=e.attr("y"),c=parseFloat(e.attr("dy")||0),s=e.attr("class","wrapped "+r).text(null).append("tspan").attr("class",r).attr("x",e.attr("x")).attr("y",l).attr("dy",c+"em");t=n.pop();)a.push(t),s.text(a.join(" ")),s.node().getComputedTextLength()>e.datum().wE-30&&(a.pop(),s.text(a.join(" ")),a=[t],s=e.append("tspan").attr("class",r).attr("x",e.attr("x")).attr("y",l).attr("dy",++i*o+c+"em").text(t))})}function g(t){window._.each(t[0],function(t){t=window.d3.select(t);var e=t.selectAll("tspan"),n=e[0].length,r=n%2===0?!0:!1,a=Math.floor(n/2),i=1.2,o=i;r?(o=i/2,a--,a*=i,a+=o,a*=-1):(a*=o,a*=-1),e.each(function(){var t=window.d3.select(this);t.attr("dy",parseFloat(t.attr("dy").replace("em",""))+a+"em")})})}function v(t){var e=window._.select(ft,function(e){return""!==e[t]}),n=window._.pluck(e,t);return n=window._.uniq(n)}function m(){var t=v("lineaini"),e=[],n=0,r=0,a=0,i={},o=[];window._.each(t,function(t){e=window._.select(ft,{lineaini:t}),i=window._.min(e,"x"),n=i.x,i=window._.min(e,"yi"),r=i.yi,i=window._.max(e,"yf"),a=i.yf,o.push({x1:n,x2:n,y1:r,y2:a})}),t=v("lineafin"),window._.each(t,function(t){e=window._.select(ft,{lineafin:t}),i=window._.min(e,"x"),n=i.x+i.w,i=window._.min(e,"yi"),r=i.yi,i=window._.max(e,"yf"),a=i.yf,o.push({x1:n,x2:n,y1:r,y2:a})}),Zt.selectAll("line.pleca").data(o).enter().append("line").attr("class","pleca").style("stroke","#000000").style("stroke-width",et).style("opacity",1).attr("x1",function(t){return t.x1}).attr("y1",function(t){return t.y1}).attr("x2",function(t){return t.x2}).attr("y2",function(t){return t.y2});var l=window.d3.svg.symbol().type("triangle-up").size(tt),c=_(tt),s=Q/2,d=window._.select(ft,{pleca:!0});Zt.selectAll("path.pleca").data(d).enter().append("path").attr("d",l).attr("class","pleca").attr("transform",function(t){return"translate("+(t.x+c)+","+(t.y+s)+"), rotate(90)"});var f=[],u=[],p=c,y=null,w=null,h=[];window._.each(ut,function(t){h=window._.select(ft,{id:t.destino}),w=window._.min(h,"inicio"),y=window._.find(ft,function(e){return e.id===t.origen&&e.inicio<=w.inicio&&w.inicio<=e.fin}),f.push({x1:w.x-10,x2:w.x+et/2,y1:y.yi+y.h/2+t.offset,y2:y.yi+y.h/2+t.offset}),w.yi>=y.yi?(f.push({x1:w.x,x2:w.x,y1:y.yi+y.h/2+t.offset,y2:w.yi-p}),u.push({x:w.x,y:w.yi,o:-p,rot:180})):(f.push({x1:w.x,x2:w.x,y1:y.yi+y.h/2+t.offset,y2:w.yf+p}),u.push({x:w.x,y:w.yf,o:p,rot:0}))}),Zt.selectAll("line.flecha").data(f).enter().append("line").attr("class","flecha").style("stroke","#000000").style("stroke-width",et).style("opacity",1).attr("x1",function(t){return t.x1}).attr("y1",function(t){return t.y1}).attr("x2",function(t){return t.x2}).attr("y2",function(t){return t.y2}),Zt.selectAll("path.flecha").data(u).enter().append("path").attr("d",l).attr("class","flecha").attr("transform",function(t){return"translate("+t.x+","+(t.y+t.o)+"), rotate("+t.rot+")"})}function _(t){var e=Math.sqrt(3)/2,n=Math.sqrt(e*t*2);return Math.floor(n/2)-2}function A(){var t=v("lineaini"),e=[],n=0,r=0,a=0,i={},o=[];window._.each(t,function(t){e=window._.select(ft,{lineaini:t}),i=window._.min(e,"x"),n=i.xE,i=window._.min(e,"yi"),r=i.yi,i=window._.max(e,"yf"),a=i.yf,o.push({x1:n,x2:n,y1:r,y2:a})}),t=v("lineafin"),window._.each(t,function(t){e=window._.select(ft,{lineafin:t}),i=window._.min(e,"x"),n=i.xE+i.wE,i=window._.min(e,"yi"),r=i.yi,i=window._.max(e,"yf"),a=i.yf,o.push({x1:n,x2:n,y1:r,y2:a})}),St.selectAll("line.pleca").data(o).enter().append("line").attr("class","pleca").style("stroke","#000000").style("stroke-width",et).style("opacity",1).attr("x1",function(t){return t.x1}).attr("y1",function(t){return t.y1}).attr("x2",function(t){return t.x2}).attr("y2",function(t){return t.y2});var l=window.d3.svg.symbol().type("triangle-up").size(tt),c=_(tt),s=Q/2,d=window._.select(ft,{pleca:!0});St.selectAll("path.pleca").data(d).enter().append("path").attr("d",l).attr("class","pleca").attr("transform",function(t){return"translate("+(t.xE+c)+","+(t.y+s)+"), rotate(90)"});var f=[],u=[],p=c,y=null,w=null,h=[];window._.each(ut,function(t){h=window._.select(ft,{id:t.destino}),w=window._.min(h,"inicio"),y=window._.find(ft,function(e){return e.id===t.origen&&e.inicio<=w.inicio&&w.inicio<=e.fin}),f.push({x1:w.xE-60,x2:w.xE+et/2,y1:y.yi+y.h/2+t.offset,y2:y.yi+y.h/2+t.offset}),w.yi>=y.yi?(f.push({x1:w.xE,x2:w.xE,y1:y.yi+y.h/2+t.offset,y2:w.yi-p}),u.push({x:w.xE,y:w.yi,o:-p,rot:180})):(f.push({x1:w.xE,x2:w.xE,y1:y.yi+y.h/2+t.offset,y2:w.yf+p}),u.push({x:w.xE,y:w.yf,o:p,rot:0}))}),St.selectAll("line.flecha").data(f).enter().append("line").attr("class","flecha").style("stroke","#000000").style("stroke-width",et).style("opacity",1).attr("x1",function(t){return t.x1}).attr("y1",function(t){return t.y1}).attr("x2",function(t){return t.x2}).attr("y2",function(t){return t.y2}),St.selectAll("path.flecha").data(u).enter().append("path").attr("d",l).attr("class","flecha").attr("transform",function(t){return"translate("+t.x+","+(t.y+t.o)+"), rotate("+t.rot+")"}),St.append("rect")}function b(){var t=null,e=[],n=Zt.selectAll("text.wrapped");n.each(function(n){t=this.getBBox(),e.push({color:n.color,borde:n.borde,x:t.x-at,y:t.y-it,width:t.width+2*at,height:t.height+2*it,clase:n.id})}),Ut.selectAll("rect.etiqueta").data(e).enter().append("rect").attr("class",function(t){return"etiqueta "+t.clase}).style("fill",function(t){return t.color}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",function(t){return t.height}).attr("stroke",function(t){return t.borde}).attr("stroke-width",2)}function k(){var t=null,e=[],n=St.selectAll("text.wrapped");n.each(function(n){t=this.getBBox();var r=t.x-at,a=t.y-it,i=t.height+2*it,o=t.width+2*at;e.push({color:n.color,borde:n.borde,x:r,y:a,width:o,height:i,clase:n.id,anio:n.anio});var l=r,c=r+o,s=a+i/2;oe.push({xizq:parseInt(l),xder:parseInt(c),ycentro:parseInt(s),cartel:n.id,anio:n.anio})}),Ft.selectAll("rect.etiqueta").data(e).enter().append("rect").attr("class",function(t){return"etiqueta "+t.clase}).style("fill",function(t){return t.color}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",function(t){return t.height}).attr("stroke",function(t){return t.borde}).attr("stroke-width",2),Vt.selectAll("rect.etiqueta.normal").data(e).enter().append("rect").attr("class",function(t){return"ignorar etiqueta normal "+t.clase}).style("fill",function(t){return t.color}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",function(t){return t.height}).attr("stroke",function(t){return t.borde}).attr("stroke-width",2).style("display","none"),Wt.selectAll("text.cartel.resaltado").style("display","block"),e=[],n=Wt.selectAll("text.wrapped.resaltado"),n.each(function(n){t=this.getBBox();var r=t.x-at,a=t.y-it,i=t.height+2*it,o=t.width+2*at;e.push({color:n.color,borde:n.borde,x:r,y:a,width:o,height:i,clase:n.id,anio:n.anio});var l=r,c=r+o,s=a+i/2;le.push({xizq:parseInt(l),xder:parseInt(c),ycentro:parseInt(s),cartel:n.id,anio:n.anio})}),Wt.selectAll("text.cartel.resaltado").style("display","none"),Vt.selectAll("rect.etiqueta.resaltado").data(e).enter().append("rect").attr("class",function(t){return"ignorar etiqueta resaltado "+t.clase}).style("fill",function(t){return t.color}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",function(t){return t.height}).attr("stroke",function(t){return t.borde}).attr("stroke-width",2).style("display","none")}function z(){var t=G*dt.length,e=window.$(Mt.node()).width();Gt.selectAll("rect.presidente").each(function(n,r){var a=null,i=dt[r],o=i.id,l=window._.select(ht,{presidente:o}),c="<p><strong>Sexenio de ";c+=i.nombre,c+=" </strong></p>",c+="<hr>",c+="<h2> ",c+=l.length,c+=" conflictos registrados</h2>",c+="<hr>",c+="<ol>",window._.each(l,function(t){c+="<li>";var e=t.bando1,n=t.bando2,r=[],i=[];window._.each(e,function(t){var e=window._.find(ft,{id:t});if(e=e||!1,e!==!1){var n='<span style="color:'+e.fondo+'"><strong>';n+=e.nombree,n+="</strong></span>",r.push(n)}}),a=r.join(" + "),null===t.federacion?c+=a:3===r.length?(c+="<strong>"+t.federacion+"</strong>",c+=" (",c+=a,c+=")"):c+=a,c+=" <em>vs.</em> ",window._.each(n,function(t){var e=window._.find(ft,{id:t});if(e=e||!1,e!==!1){var n='<span style="color:'+e.fondo+'"><strong>';n+=e.nombree,n+="</strong></span>",i.push(n)}}),a=i.join(" + "),null===t.federacion?c+=a:3===i.length?(c+="<strong>"+t.federacion+"</strong>",c+=" (",c+=a,c+=")"):c+=a,c+="</li>"}),c+="</ol>",$(this).tooltipster({theme:"tooltipster tooltipster-numeroconflictos",offsetX:(G-(lt/2+ct))/(t/e),offsetY:(U-ct)/(t/e),content:$(c),maxWidth:G-30,functionReady:H})}),Jt.selectAll("rect.presidente").each(function(n,r){var a=null,i=dt[r],o=i.id,l=window._.select(ht,{presidente:o}),c="<p><strong>Sexenio de ";c+=i.nombre,c+=" </strong></p>",c+="<hr>",c+="<h2> ",c+=l.length,c+=" conflictos registrados</h2>",c+="<hr>",c+="<ol>",window._.each(l,function(t){c+="<li>";var e=t.bando1,n=t.bando2,r=[],i=[];window._.each(e,function(t){var e=window._.find(ft,{id:t});if(e=e||!1,e!==!1){var n='<span style="color:'+e.fondo+'"><strong>';n+=e.nombree,n+="</strong></span>",r.push(n)}}),a=r.join(" + "),null===t.federacion?c+=a:3===r.length?(c+="<strong>"+t.federacion+"</strong>",c+=" (",c+=a,c+=")"):c+=a,c+=" <em>vs.</em> ",window._.each(n,function(t){var e=window._.find(ft,{id:t});if(e=e||!1,e!==!1){var n='<span style="color:'+e.fondo+'"><strong>';n+=e.nombree,n+="</strong></span>",i.push(n)}}),a=i.join(" + "),null===t.federacion?c+=a:3===i.length?(c+="<strong>"+t.federacion+"</strong>",c+=" (",c+=a,c+=")"):c+=a,c+="</li>"}),c+="</ol>",$(this).tooltipster({theme:"tooltipster tooltipster-numeroconflictos",offsetX:(G-(lt/2+ct))/(t/e),offsetY:(U-ct)/(t/e),content:$(c),maxWidth:G-30,functionReady:H})}),Yt.selectAll("circle.oponente").each(function(n,r){var a="<p><strong>Conflicto ";a+=n.numero,a+=" de ",a+=n.total,a+=" (sexenio de ";var i=window._.find(dt,{id:n.presidente});if(a+=i.nombrecorto,a+=")</strong></p>",a+="<hr>",a+="<p>",n.cartelesfederacion=n.cartelesfederacion||[],null!==n.federacion)if(0!==n.cartelesfederacion.length&&0!==n.alianza.length)a+='<span style="color:'+n.cartel.fondo+'"><strong>',a+=n.cartel.nombree,a+="</strong></span>";else{var o=[];window._.each(n.cartelesfederacion,function(t){var e=window._.find(ft,{id:t});o.push('<span style="color:'+e.fondo+'"><strong>'+e.nombree+"</strong></span>")}),a+="<strong>"+n.federacion+"</strong> ("+o.join(" + ")+")"}else a+='<span style="color:'+n.cartel.fondo+'"><strong>',a+=n.cartel.nombree,a+="</strong></span>";if(a+=" <em>vs.</em> ",0===n.alianza.length)a+='<span style="color:'+n.fondo+'"><strong>',a+=n.nombree,a+="</strong></span>";else{var l="",c=[];window._.each(n.alianza,function(t){var e='<span style="color:'+t.fondo+'"><strong>';e+=t.nombree,e+="</strong></span>",c.push(e)}),l=c.join(" + "),null===n.federacion?a+=l:(a+="<strong>"+n.federacion+"</strong>",a+=" (",a+=l,a+=")")}a+="</p>";var s=n.descripcion;s=s||!1,s!==!1&&(a+="<hr>",a+="<p>",a+=s,a+="</p>"),$(this).tooltipster({theme:"tooltipster tooltipster-numeroconflictos",offsetX:mt/(t/e),offsetY:(U-ct)/(t/e),content:$(a),maxWidth:G-30,functionReady:H})})}function H(t,e){var n=$(e[0]).find("div").html();$(t).tooltipster("content",$(n))}function E(){var t=c(),e=(Q+Z)*ft.length,n=[],r=[];Kt.selectAll("rect.federacion").data(pt).enter().append("rect").attr("class",function(t){return"federacion "+t.id}).attr("x",function(e){var r=(e.inicio-t)*D;return n.push(r),r}).attr("y",U).attr("width",function(t){return t.w=(t.fin-t.inicio)*D,t.w}).attr("height",e).style("fill",function(t){return t.color}),Ut.selectAll("text.federacion.titulo").data(yt).enter().append("text").attr("class","federacion titulo").attr("text-anchor","middle").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",16).style("text-transform","uppercase").style("font-weight","bold").attr("fill",function(t){var e=window._.find(pt,{id:t.id});return e.fuente}).attr("x",function(e){var n=window._.find(pt,{id:e.id}),r=n.inicio-t,a=n.fin-n.inicio,i=(r+a/2)*D;return e.x=i,i}).attr("y",function(t){return t.y}).text(function(t){var e=window._.find(pt,{id:t.id});return e.nombre}),Ut.selectAll("text.federacion.fechas").data(yt).enter().append("text").attr("class","federacion fechas").attr("text-anchor","middle").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",14).attr("fill","#000000").attr("x",function(t){return t.x}).attr("y",function(t){var e=t.y+20;return r.push(t.y+20),e}).text(function(t){var e=window._.find(pt,{id:t.id});return e.inicio+" - "+e.fin});var a=window.d3.svg.symbol().type("cross").size(80);Kt.append("circle").attr("cx",n[0]+62).attr("cy",r[0]+20).attr("r",12).style("fill","#e1a632"),Kt.append("circle").attr("cx",n[0]+84).attr("cy",r[0]+20).attr("r",12).style("fill","#8fc64f"),Ut.append("path").attr("d",a).attr("transform",function(t){return"translate("+(n[0]+74)+","+(r[0]+20)+")"}),Kt.append("circle").attr("cx",n[0]+138).attr("cy",r[0]+20).attr("r",12).style("fill","#54c8f2"),Ut.append("text").attr("class","federacion etiqueta").attr("text-anchor","middle").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",10).style("font-style","italic").attr("fill","#000000").attr("x",n[0]+112).attr("y",r[0]+25).text("VS."),Kt.append("circle").attr("cx",n[1]+14).attr("cy",r[1]+20).attr("r",12).style("fill","#e1a632"),Kt.append("circle").attr("cx",n[1]+38).attr("cy",r[1]+20).attr("r",12).style("fill","#8fc64f"),Ut.append("path").attr("d",a).attr("transform",function(t){return"translate("+(n[1]+26)+","+(r[1]+20)+")"}),Kt.append("circle").attr("cx",n[1]+80).attr("cy",r[1]+20).attr("r",12).style("fill","#54c8f2"),Kt.append("circle").attr("cx",n[1]+105).attr("cy",r[1]+20).attr("r",12).style("fill","#b09bc7"),Ut.append("text").attr("class","federacion etiqueta").attr("text-anchor","middle").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",10).style("font-style","italic").attr("fill","#000000").attr("x",n[1]+60).attr("y",r[1]+25).text("VS.")}function q(t,e,n){te.selectAll("rect.telon").data(dt).enter().append("rect").attr("class","telon").attr("x",function(t,e){return e*G}).attr("y",U).attr("width",G).attr("height",e).style("fill","#ffffff").style("stroke","#ffffff").style("stroke-width",2).style("opacity",0).on("click",function(e){M(e,t,this,n)}).on("mouseover",function(t){window.d3.select(this).style("opacity",.9)}).on("mouseout",function(t){window.d3.select(this).style("opacity",.7)}).transition("agregartelon").duration(200).style("fill","#000000").style("opacity",.7)}function j(t,e){t.each(function(){var t=e.node().appendChild(this.cloneNode(!0));window.d3.select(t).attr("class","clon")})}function N(t,e){bt=Gt.append("svg").attr("width",t).attr("height",e),kt=Jt.append("svg").attr("width",t).attr("height",e),bt.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",e).style("fill","#ffffff"),kt.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",e).style("fill","#ffffff"),j(Kt,bt),j(Qt,bt),j(Ut,bt),j(Zt,bt),j(ee,bt),j(ne,bt),j(te,bt),bt.selectAll("g.clon").attr("transform",null),j(Kt,kt),j(Qt,kt),j(Ut,kt),j(Zt,kt),j(ee,kt),j(ne,kt),j(te,kt),kt.selectAll("g.clon").attr("transform",null)}function M(t,e,n,r){if(gt===!1){gt=!0,t.click=!0;var a=window.d3.select(n),i=Ct.node(),o=window.d3.mouse(i),l=o[0];l-=st,Ht=C(l),W(Ht,r,!1),a.transition("quitartelon").duration(200).style("fill","#000000").style("opacity",.7).each("end",function(t){re.select("rect.eje").transition("cambiareje").duration(2e3).style("fill","#ff0000").each("end",function(){re.select("rect.eje").classed("pointer",!0),re.select("text").classed("pointer",!0).text("Regresar")}),Ct.selectAll("g.fade").style("opacity",0),te.attr("transform","translate("+st+","+10*-ot+")"),Ct.selectAll("g.extendida").attr("transform","translate("+-Ht+",0)"),Jt.select("svg").attr("width",l),Gt.attr("transform","translate("+(l+st)+",0)"),Gt.select("svg").attr("width",e-l).selectAll(".clon").attr("transform","translate("+-l+",0)"),Gt.selectAll("rect.telon").style("fill","#000000").style("opacity",.7),Jt.selectAll("rect.telon").style("fill","#000000").style("opacity",.7),Jt.transition().duration(2e3).attr("transform","translate("+-l+",0)"),Gt.transition().duration(2e3).attr("transform","translate("+(e+st)+",0)")})}}function C(t){return 5*t-st}function O(){if(gt===!0){gt=!1,window._.each(dt,function(t){t.click=!1}),re.select("rect.eje").classed("pointer",!1),re.select("text").classed("pointer",!1),re.select("rect.eje").transition("regresareje").duration(2e3).style("fill","#58595b").each("end",function(){re.select("text").text("Cárteles")}),Gt.selectAll("rect.telon").style("fill","#000000").style("opacity",.7);var t=+Jt.select("svg").attr("width");Jt.selectAll("rect.telon").style("fill","#000000").style("opacity",.7),Jt.transition().duration(2e3).attr("transform","translate("+st+",0)").each("end",function(){
R(1)}),Gt.transition().duration(2e3).attr("transform","translate("+(t+st)+",0)").each("end",function(){R(1)})}}function R(t){zt+=t,2===zt&&(zt=0,Ct.selectAll("g.fade").style("opacity",null),te.attr("transform","translate("+st+",0)"),Jt.selectAll("rect.telon").style("opacity",0),Gt.selectAll("rect.telon").style("opacity",0),te.selectAll("rect.telon").style("fill","#000000").style("opacity",.7))}function I(t){Et=!1,window.d3.selectAll("g.extendida").classed("grab",!0),window.d3.selectAll("g.extendida").classed("grabbing",!1)}function B(t){Et=!1,window.d3.selectAll("g.extendida").classed("grab",!0),window.d3.selectAll("g.extendida").classed("grabbing",!1)}function F(t,e){var n=t[0],r=t[1];window.d3.selectAll("g.extendida").classed("grab",!1),window.d3.selectAll("g.extendida").classed("grabbing",!0),Et===!1&&(Et=window.d3.event.x);var a=Et-window.d3.event.x;Ht+=a,Ht=Math.max(n,Math.min(r,Ht)),W(Ht,e,!0)}function S(t,e){Dt.attr("transform","translate("+st+","+e+")"),Dt.append("rect").attr("fill","#000000").style("stroke","#ffff").style("stroke-width",jt).attr("height",qt+2*jt).attr("width",t).attr("class","slidercontrolgroup pointer");var n=Dt.append("g").attr("class","slidercontrolgroup");n.append("rect").attr("fill","#ff0000").attr("height",qt+2*jt).attr("width",Nt).attr("x",0).attr("y",0),n.append("line").style("stroke","#000000").attr("x1",Nt/2).attr("x2",Nt/2).attr("y1",jt).attr("y2",qt+jt);var r=window.d3.svg.symbol().type("triangle-up").size(25);n.append("path").attr("d",r).attr("transform","translate("+3*Nt/4+","+(qt/2+jt)+"), rotate(90)"),n.append("path").attr("d",r).attr("transform","translate("+Nt/4+","+(qt/2+jt)+"), rotate(270)")}function Y(t){Dt.select("g.slidercontrolgroup").classed("grab",!0).classed("grabbing",!1)}function P(t){Dt.select("g.slidercontrolgroup").classed("grab",!0).classed("grabbing",!1)}function T(t,e){var n=t[0],r=t[1];Dt.select("g.slidercontrolgroup").classed("grab",!1).classed("grabbing",!0);var a=Math.max(n,Math.min(r,window.d3.event.x));X(a,e)}function V(t,e,n){var r=window.d3.mouse(t),a=r[0],i=e[0],o=e[1],a=Math.max(i,Math.min(o,a));X(a,n)}function W(t,e,n){n=n||!1;var r=e(t);Dt.select("g.slidercontrolgroup").attr("transform","translate("+(r-Nt/2)+",0)"),n&&Ct.selectAll("g.extendida").attr("transform","translate("+-t+",0)")}function X(t,e){Ht=e(t),Dt.select("g.slidercontrolgroup").attr("transform","translate("+(t-Nt/2)+",0)"),Ct.selectAll("g.extendida").attr("transform","translate("+-Ht+",0)")}function L(t){var e=[],n=null,r=null,a=[],i=null,o=null,l=null,n=null,c=null,s=0,d=0,f=0;window._.each(t,function(t){for(f=t.inicio;f<=t.fin;f++)n=window._.find(dt,{id:t.presidente}),l=t.descripcion,s=t.numero,d=t.total,n=t.presidente,c=t.federacion,c=c||null,a=[],null!==c&&(3===t.bando1.length&&(a=window._.clone(t.bando1)),3===t.bando2.length&&(a=window._.clone(t.bando2))),window._.each(t.bando1,function(u){r=window._.find(ft,function(t){var e=t.id===u?!0:!1,n=t.inicio<=f&&f<t.fin;return e&&n});var p=[],y=[];window._.each(t.bando2,function(t){i=window._.clone(window._.find(ft,function(e){var n=e.id===t?!0:!1,r=e.inicio<=f&&f<e.fin;return n&&r})),i.descripcion=l,i.numero=s,i.total=d,i.presidente=n,i.federacion=c,i.cartelesfederacion=window._.clone(a),i.anio=f,y.push(i)}),p.push(y),o=window._.find(e,function(t){var e=t.anio===f?!0:!1,n=t.cartel.id===r.id;return e&&n}),o=o||!1,o!==!1?o.oponentes.push(y):e.push({cartel:r,presidente:n,anio:f,oponentes:p})}),window._.each(t.bando2,function(u){r=window._.find(ft,function(t){var e=t.id===u?!0:!1,n=t.inicio<=f&&f<t.fin;return e&&n});var p=[],y=[];window._.each(t.bando1,function(t){i=window._.clone(window._.find(ft,function(e){var n=e.id===t?!0:!1,r=e.inicio<=f&&f<e.fin;return n&&r})),i.descripcion=l,i.numero=s,i.total=d,i.presidente=n,i.federacion=c,i.cartelesfederacion=window._.clone(a),i.anio=f,y.push(i)}),p.push(y),o=window._.find(e,function(t){var e=t.anio===f?!0:!1,n=t.cartel.id===r.id;return e&&n}),o=o||!1,o!==!1?o.oponentes.push(y):e.push({cartel:r,presidente:n,anio:f,oponentes:p})})}),window._.each(e,function(t){var e=[],n=window._.clone(t.oponentes);t.oponentes=[],window._.each(n,function(n){var r=window._.pluck(n,"id").join("-");e.indexOf(r)<0&&(e.push(r),t.oponentes.push(n))})});return window._.each(e,function(t){var e=[],n=window._.select(t.oponentes,function(t){return t.length<2?!0:!1});n=n||[];var r=window._.select(t.oponentes,function(t){return t.length>=2?!0:!1});r=r||[];var a=[];window._.each(r,function(t){var e=window._.pluck(t,"id");window._.each(e,function(t){a.push(t)})}),a=window._.uniq(a),window._.each(n,function(t){t=t[0];var n=t.id;a.indexOf(n)<0&&e.push([t])}),window._.each(r,function(t){e.push(t)}),t.oponentes=window._.clone(e)}),e}var D=40,G=6*D,J=G,K=6*J,Q=50,U=70,Z=4,tt=200,et=5,nt=53,rt=35,at=2,it=2,ot=0,lt=50,ct=10,st=40,dt=[],ft=[],ut=[],pt=[],yt=[],wt=[],ht=[],xt=[],gt=!1,vt=5,mt=14,_t=0,At=25,bt=null,kt=null,zt=0,Ht=0,Et=!1,qt=10,jt=2,Nt=80,Mt=window.d3.select("#contenedor01ch"),Ct=Mt.append("svg").attr("preserveAspectRatio","xMidYMid").attr("id","svg"),Ot=Ct.append("rect"),Rt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gFederacionesE"),$t=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gTelonE"),It=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gHilosE"),Bt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gCartelesE"),Ft=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gEtiquetasE"),St=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gPlecasE"),Yt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gConflictosE"),Pt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gCartelesR"),Tt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gColumnasE"),Vt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gEtiquetasR"),Wt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gPlecasR"),Xt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gHilosR"),Lt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","extendida").attr("id","gEncabezadoE"),Dt=Ct.append("g").attr("transform","translate("+st+",0)"),Gt=Ct.append("g").attr("transform","translate("+st+",0)").attr("id","gClonDerecho"),Jt=Ct.append("g").attr("transform","translate("+st+",0)").attr("id","gClonIzquierdo"),Kt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","fade"),Qt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","fade"),Ut=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","fade"),Zt=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","fade"),te=Ct.append("g").attr("id","gTelon").attr("class","fade"),ee=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","fade"),ne=Ct.append("g").attr("transform","translate("+st+",0)").attr("class","fade"),re=Ct.append("g"),ae=null,ie=[],oe=[],le=[];return ajustaCarteles=function(){var t=U+Z,e=0,n=window._.pluck(ft,"fila");n=window._.uniq(n),n.sort(function(t,e){return t-e}),window._.each(n,function(n){var r=0,a=0,i=0,o=window._.select(ft,{fila:n}),l=window._.pluck(o,"id");l=window._.uniq(l),window._.each(l,function(e){var n=Qt.selectAll("rect.cartel."+e);n.each(function(t){t.h>r&&(r=t.h,a=t.yi)});var o=Ut.selectAll("rect."+e);o.each(function(t){t.height>r&&(r=t.height,a=t.y)}),i=a-t,n.each(function(t){t.y=t.y-i,t.yi=t.yi-i,t.yf=t.yf-i}),Zt.selectAll("tspan."+e).each(function(){var t=window.d3.select(this);t.attr("y",t.attr("y")-i)}),Ut.selectAll("rect."+e).each(function(t){t.y=t.y-i})}),n!==e&&(t+=r+Z)}),Qt.selectAll("rect.cartel").attr("y",function(t){return t.yi}),Zt.selectAll("text.cartel").attr("y",function(t){return t.y+30}),Ut.selectAll("rect").attr("y",function(t){return t.y});var r=Qt.selectAll("rect.cartel");r.each(function(t){t.h+t.yi>ot&&(ot=t.h+t.yi)});var a=Ut.selectAll("rect");a.each(function(t){t.height+t.y>ot&&(ot=t.height+t.y)}),ot+=Z},generaFederacionesE=function(){var t=c(),e=(Q+Z)*ft.length,n=[],r=[];Rt.selectAll("rect.federacion").data(pt).enter().append("rect").attr("class",function(t){return"federacion "+t.id}).attr("x",function(e){var r=(e.inicio-t)*J;return n.push(r),r}).attr("y",U).attr("width",function(t){return t.w=(t.fin-t.inicio)*J,t.w}).attr("height",e).style("fill",function(t){return t.color}),Rt.selectAll("text.federacion.titulo").data(yt).enter().append("text").attr("class","federacion titulo").attr("text-anchor","middle").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",16).style("font-weight","bold").style("text-transform","uppercase").attr("fill",function(t){var e=window._.find(pt,{id:t.id});return e.fuente}).attr("x",function(e){var n=window._.find(pt,{id:e.id}),r=n.inicio-t,a=n.fin-n.inicio,i=(r+a/2)*J;return e.x=i,i}).attr("y",function(t){return t.y}).text(function(t){var e=window._.find(pt,{id:t.id});return e.nombre}),Rt.selectAll("text.federacion.fechas").data(yt).enter().append("text").attr("class","federacion fechas").attr("text-anchor","middle").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",14).attr("fill","#000000").attr("x",function(t){return t.x}).attr("y",function(t){var e=t.y+20;return r.push(t.y+20),e}).text(function(t){var e=window._.find(pt,{id:t.id});return e.inicio+" - "+e.fin});var a=window.d3.svg.symbol().type("cross").size(80);Rt.append("circle").attr("cx",n[0]+562).attr("cy",r[0]+20).attr("r",12).style("fill","#e1a632"),Rt.append("circle").attr("cx",n[0]+584).attr("cy",r[0]+20).attr("r",12).style("fill","#8fc64f"),Rt.append("path").attr("d",a).attr("transform",function(t){return"translate("+(n[0]+574)+","+(r[0]+20)+")"}),Rt.append("circle").attr("cx",n[0]+638).attr("cy",r[0]+20).attr("r",12).style("fill","#54c8f2"),Rt.append("text").attr("class","federacion etiqueta").attr("text-anchor","middle").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",10).style("font-style","italic").attr("fill","#000000").attr("x",n[0]+612).attr("y",r[0]+25).text("VS."),Rt.append("circle").attr("cx",n[1]+314).attr("cy",r[1]+20).attr("r",12).style("fill","#e1a632"),Rt.append("circle").attr("cx",n[1]+338).attr("cy",r[1]+20).attr("r",12).style("fill","#8fc64f"),Rt.append("path").attr("d",a).attr("transform",function(t){return"translate("+(n[1]+326)+","+(r[1]+20)+")"}),Rt.append("circle").attr("cx",n[1]+380).attr("cy",r[1]+20).attr("r",12).style("fill","#54c8f2"),Rt.append("circle").attr("cx",n[1]+405).attr("cy",r[1]+20).attr("r",12).style("fill","#b09bc7"),Rt.append("text").attr("class","federacion etiqueta").attr("text-anchor","middle").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",10).style("font-style","italic").attr("fill","#000000").attr("x",n[1]+360).attr("y",r[1]+25).text("VS.")},generaConflictos=function(){var t=[],e=[];window._.each(wt,function(n){var r=n.cartel.yi+(n.cartel.yf-n.cartel.yi)/2,a=n.anio-n.cartel.inicio,i=n.cartel.xE+a*J;i+=mt,window._.each(n.oponentes,function(a){var o=[];i+=vt,a.length>1&&(t.push({x:i+mt,y:r,num:a.length-1,aux:a.length}),window._.each(a,function(t){o.push({nombree:t.nombree,fondo:t.fondo})})),window._.each(a,function(t){var a=window._.clone(t);a.alianza=o,Yt.append("circle").datum(a).attr("class",function(t){return t.cartel=n.cartel,e.push(t),"auto oponente "+t.id}).style("fill",function(t){return t.fondo}).style("stroke",function(t){return t.anillo}).attr("stroke-width",2).attr("cx",function(t){return t.cx=i,t.cx}).attr("cy",function(t){return t.cy=r,t.cy}).attr("r",mt),i+=2*mt})}),Yt.selectAll("text").data(e).enter().append("text").attr("class","auto conflicto ignorar").attr("text-anchor","middle").style("font-family",'"Helvetica Neue", Helvetica, Arial, sans-serif').style("font-size",13).style("font-weight","bold").attr("fill","#000000").attr("x",function(t){return t.cx}).attr("y",function(t){return t.cy+4}).text(function(t){return t.inicialc})});var n=window.d3.svg.symbol().type("cross").size(81);window._.each(t,function(t){var e=t.x,r=t.y,a=0;for(a=1;a<=t.num;a++)e+=2*mt*(a-1),Yt.append("path").attr("class","auto alianza ignorar").attr("d",n).attr("transform","translate("+e+","+r+")")})},limpiaResaltados=function(){ae=null,window._.each(ie,function(t){t.resaltar=!1}),p()},generaHilos=function(){var t=window.d3.svg.symbol().type("triangle-up").size(100),e=window.d3.svg.symbol().type("triangle-down").size(100),n=window.d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("basis"),r=Yt.selectAll("circle.oponente");r.each(function(r){var a=null,i=null,o=r.cy,l=r.yi,c=null,s=null,d=null,f=null,u=null,p=null,y=null,w=null;o>=l?(f=window._.find(oe,{cartel:r.cartel.id,anio:r.anio}),u=window._.find(oe,{cartel:r.id,anio:r.anio}),c=!0,a=f.xizq,i=u.xizq,s=f.ycentro,d=u.ycentro,y=window._.min([a,i])):(f=window._.find(oe,{cartel:r.cartel.id,anio:r.anio}),u=window._.find(oe,{cartel:r.id,anio:r.anio}),c=!1,a=f.xder,i=u.xder,s=f.ycentro,d=u.ycentro,w=window._.max([a,i]));var h=parseInt((d-s)/2),x=null,g=[];g.push({x:a,y:s}),c===!0?(p=y-50,x={punta:t,x:i,y:d}):(p=w+50,x={punta:e,x:i,y:d}),g.push({x:p,y:d-h}),g.push({x:i,y:d}),It.append("path").attr("d",n(g)).attr("class","ignorar").attr("stroke","#000000").style("opacity","0.20").attr("stroke-width","4px").attr("fill","none"),Xt.append("path").datum(r).attr("d",n(g)).style("stroke",r.cartel.color).attr("class","cartel ignorar "+r.cartel.id).attr("stroke-width","4px").attr("fill","none").style("opacity","0.8").style("display","none");var v=getAngulo(g[1],g[2]);c===!1&&(v+=180),Xt.append("path").datum(r).attr("class","punta ignorar "+r.cartel.id).attr("d",x.punta).attr("fill",r.cartel.color).attr("transform",function(t){return"translate("+i+","+d+"), rotate("+v+")"}).style("display","none")})},getAngulo=function(t,e){var n=180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI;return n+=90},{init:t}}();